```{r}

glimpse(diabetes_dataset)
library(dplyr)
library(ggplot2)

# Prepare the data
bmi_heart_gender <- diabetes_dataset %>%
  filter(heart_disease == 1) %>%
  mutate(
    bmi_category = case_when(
      bmi <= 19 ~ "Underweight",
      bmi >= 30 ~ "Overweight",
      TRUE ~ NA_character_
    )
  ) %>%
  filter(!is.na(bmi_category)) %>%
  group_by(gender, bmi_category) %>%
  summarise(count = n(), .groups = 'drop') %>%
  group_by(gender) %>%
  mutate(percentage = round(100 * count / sum(count), 1))

# Plot
ggplot(bmi_heart_gender, aes(x = bmi_category, y = count, fill = gender)) +
  geom_bar(stat = "identity", position = position_dodge(width = 0.7)) +
  geom_text(aes(label = paste0(count, " (", percentage, "%)")),
            vjust = -0.5,
            position = position_dodge(width = 0.7)) +
  labs(
    title = "Count and Percentage of Heart Disease Cases by Gender and BMI Category",
    x = "BMI Category",
    y = "Count of People with Heart Disease",
    fill = "Gender"
  ) +
  theme_minimal()

```

```{r}
library(dplyr)
library(ggplot2)

# Data prep
bmi_heart_gender <- diabetes_dataset %>%
  filter(heart_disease == 1) %>%
  mutate(
    bmi_category = case_when(
      bmi <= 19 ~ "Underweight",
      bmi >= 30 ~ "Overweight",
      TRUE ~ NA_character_
    )
  ) %>%
  filter(!is.na(bmi_category)) %>%
  group_by(gender, bmi_category) %>%
  summarise(count = n(), .groups = 'drop') %>%
  group_by(gender) %>%
  mutate(percentage = round(100 * count / sum(count), 1))

# Make sure the bmi_category is an ordered factor so the line connects correctly
bmi_heart_gender$bmi_category <- factor(bmi_heart_gender$bmi_category,
                                        levels = c("Underweight", "Overweight"))

# Dot + Line plot
ggplot(bmi_heart_gender, aes(x = bmi_category, y = count, group = gender, color = gender)) +
  geom_line(aes(group = gender), position = position_dodge(width = 0.5), linewidth = 1) +
  geom_point(size = 5, position = position_dodge(width = 0.5)) +
  geom_text(aes(label = paste0(count, " (", percentage, "%)")),
            vjust = -1,
            position = position_dodge(width = 0.5)) +
  labs(
    title = "Heart Disease Cases by Gender and BMI Category (Dot-Line Plot)",
    x = "BMI Category",
    y = "Count of People with Heart Disease",
    color = "Gender"
  ) +
  theme_minimal()

```

```{r}
# load needed packages
library(dplyr)
library(ggplot2)

# 1. Summarise men
men_summary <- male_data %>%
  summarise(
    count = sum(bmi >= 30 & diabetes == 0),
    total = n()
  ) %>%
  mutate(
    sex        = "Men",
    percent    = count / total * 100
  )

# 2. Summarise women
women_summary <- female_data %>%
  summarise(
    count = sum(bmi >= 30 & diabetes == 0),
    total = n()
  ) %>%
  mutate(
    sex        = "Women",
    percent    = count / total * 100
  )

# 3. Combine into one data frame
summary_df <- bind_rows(men_summary, women_summary)

# 4. Plot
ggplot(summary_df, aes(x = sex, y = count, fill = sex)) +
  geom_col(width = 0.6) +
  geom_text(aes(label = sprintf("%d (%.1f%%)", count, percent)),
            vjust = -0.5, size = 4) +
  scale_y_continuous(expand = expansion(mult = c(0, 0.1))) +
  labs(
    title = "Count of Overweight (BMI ≥ 30) without Diabetes, by Sex",
    x     = NULL,
    y     = "Number of Individuals",
    fill  = NULL
  ) +
  theme_minimal(base_size = 14) +
  theme(legend.position = "none")

```

```{r}
library(dplyr)
library(ggplot2)
library(scales)

df_summary <- diabetes_dataset %>%
  mutate(
    HbA1c_cat = case_when(
      HbA1c_level < 5.7                      ~ "< 5.7 (non‑diabetic)",
      HbA1c_level >= 5.7 & HbA1c_level < 6.5 ~ "5.7–6.4 (prediabetic)",
      HbA1c_level >= 6.5                    ~ "≥ 6.5 (diabetic)"
    ),
    hypertension = factor(hypertension, levels = c(0,1),
                          labels = c("No", "Yes"))
  ) %>%
  group_by(HbA1c_cat, hypertension) %>%
  summarise(n = n(), .groups = "drop_last") %>%
  mutate(percent = n / sum(n))  # auto‑groups by HbA1c_cat




ggplot(df_summary, aes(x = HbA1c_cat,
                       y = percent,
                       fill = factor(hypertension))) +
  geom_col(position = "stack") +
  geom_text(aes(label = scales::percent(percent, 1)),
            position = position_stack(vjust = 0.5)) +
  scale_y_continuous(labels = scales::percent_format()) +
  scale_fill_discrete(name = "Hypertension",
                      labels = c("No", "Yes")) +
  labs(
    title = "Hypertension Status by HbA1c Category",
    x     = "HbA1c Category",
    y     = "Percent within Category"
  ) +
  theme_light()

```
  Within this analysis, we'll investigate factors correlated to diabetes. With a data set of 100,000 people, this investigation allows us to display relations between ages
  
  
```{r}
library(dplyr)
library(ggplot2)
library(scales)

# 1) Compute percentage within each smoking_history
smoking_diabetes_percentage <- smoking_diabetes_percentage %>%
  group_by(smoking_history) %>%
  mutate(pct = total / sum(total)) %>%
  ungroup()

# 2) Plot with geom_col + geom_text
ggplot(smoking_diabetes_percentage,
       aes(x    = smoking_history,
           y    = total,
           fill = factor(diabetes))) +
  geom_col(position = position_dodge(width = 0.9)) +
  
  # add percent labels
  geom_text(aes(label = percent(pct, accuracy = 1)),
            position = position_dodge(width = 0.9),
            vjust    = -0.5,        # nudge above bar
            size     = 3) +
  
  coord_flip() +
  scale_y_continuous(expand = expansion(mult = c(0, .1))) +
  labs(
    title   = "Smoking History and Diabetes Relationship",
    x       = "Smoking History",
    y       = "Count of People",
    fill    = "Has Diabetes",
    caption = "1 = diabetes, 0 = no diabetes"
  ) +
  theme_minimal()

```
  
```{r}
library(ggplot2)
library(dplyr)


bmi_heart_gender <- diabetes_dataset %>%
  filter(heart_disease == 1) %>%
  mutate(
    bmi_category = case_when(
      bmi <= 19 ~ "Underweight",
      bmi >= 30 ~ "Overweight",
      TRUE      ~ NA_character_
    )
  ) %>%
  filter(!is.na(bmi_category)) %>%
  group_by(gender, bmi_category) %>%
  summarise(count = n(), .groups = 'drop') %>%
  group_by(gender) %>%
  mutate(percentage = round(100 * count / sum(count), 1)) %>%
  ungroup()

bmi_heart_gender$bmi_category <- factor(bmi_heart_gender$bmi_category,
                                        levels = c("Underweight", "Overweight"))


max_ct <- max(bmi_heart_gender$count)
y_breaks <- pretty(c(0, max_ct), n = 10)    # ~10 ticks

ggplot(bmi_heart_gender,
       aes(x = bmi_category,
           y = count,
           group = gender,
           color = gender)) +
  geom_line(position = position_dodge(width = 0.5), linewidth = 1) +
  geom_point(position = position_dodge(width = 0.5), size = 5) +
  geom_text(aes(label = paste0(count, " (", percentage, "%)")),
            vjust = -1,
            position = position_dodge(width = 0.5)) +
  scale_y_continuous(
    breaks = y_breaks,
    expand = expansion(mult = c(0, .05))   # so labels don’t get clipped
  ) +
  labs(
    title = "Heart Disease Cases by Gender and BMI Category",
    x     = "BMI Category",
    y     = "Count of People with Heart Disease",
    color = "Gender"
  ) +
  theme_minimal()

```

---
title: "Adam_Section_Go_Brrr"
output: ioslides_presentation
date: "2025-04-18"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)

library(tidyverse)
library(ggplot2)

```

One of the more interesting bits of data is that there are individuals that have an a1c of over 6.5 yet are not considered diabetic.

```{r hbA1C vs Blood Sugar}

```


# Smokers go brrr# Smokers go brrrgeom_boxplot()

In the smoking data there are 6 unique values

1)  Never: Has Never smoked
2)  Not current: Has smoked but is not currently smoking
3)  Former: Has quit smoking (abstained for longer than)
4)  Current: Is currently a smoker
5)  Ever: Has ever smoked regardless of current smoking status
6)  No Info: No smoking history information available

The total amount of people who fall into each category is as follows;

1)  Never: 35095
2)  Not current: 6447
3)  Former: 9352
4)  Current: 9286
5)  Ever: 4004
6)  No Info: 35816

There is quite a sizable amount of people in the No info category.

The total number of people in the dataset is `r nrow(diabetes_dataset)`. To help clean up the data, we can filter 'No Info' people out. When we do that we get `r nrow(diabetes_dataset %>% filter(smoking_history != 'No Info'))`.

```{r Cleaning smoking data}

# Figure out the unique categories of smoking history
unique(diabetes_dataset$smoking_history)

# Count amount of people who belong to each unique smoking category
#Omit No info

smoking_data <- diabetes_dataset %>% filter(smoking_history != 'No Info')



smoking_tally <- diabetes_dataset %>% filter(smoking_history != 'No Info') %>%  group_by(smoking_history) %>% summarise(total_people = n())

#group diabetic vs non diabetic people together

smoking_diabetes_dataset <- diabetes_dataset %>%
  filter(smoking_history != 'No Info') %>%  
  group_by(smoking_history, diabetes) %>%  
  summarise(total = n())

smoking_diabetes_dataset

# Inner join tally data with diabetic grouped data;
#mutate a column to create a percentage per category;
#select desired columns

smoking_diabetes_percentage <- inner_join(smoking_tally, smoking_diabetes_dataset, by = 'smoking_history') %>% mutate(Percentage = round( total/total_people *100, digits = 2)) %>% select(smoking_history, diabetes, total, Percentage)

smoking_diabetes_percentage
```

Now we can graph the relationship between smoking and diabetes as separated by smoking category.

```{r Plotting smoking data}
library(ggplot2)
library(plotly)

#Create initial graph about smoking and diabetes

smoking_diabetes_graph <- ggplot(smoking_diabetes_percentage) + 
  geom_col(aes(x = smoking_history, y = total, fill = as.factor(diabetes)), position = 'dodge') 

smoking_diabetes_graph <- smoking_diabetes_graph + coord_flip() + labs(
  title = 'Smoking History and Diabetes Relationship',
  y = 'People',
  x = 'Smoking History',
  fill = 'Has Diabetes',
  caption = "1 indicates diabetes, 0 indicates no diabetes"
  ) 

smoking_diabetes_graph
```


```{r Smoking on that percentage pack tonight tonight}

ggplot(smoking_diabetes_percentage) + geom_col(aes(x = smoking_history, y = Percentage, fill = as.factor(diabetes)))
```




```{r heart disease and smoking}
smoking_heart_disease_data <- diabetes_dataset %>%
  filter(smoking_history != 'No Info') %>%  
  group_by(smoking_history, heart_disease) %>%  
  summarise(total = n())
smoking_heart_disease_data

smoking_heart_disease_percentage <- inner_join(smoking_tally, smoking_heart_disease_data, by = 'smoking_history') %>% mutate(Percentage = round( total/total_people *100, digits = 2)) %>% select(smoking_history, heart_disease, total, Percentage)

smoking_heart_disease_percentage

```




```{r}


```




```{r Smoking and hypertension}
smoking_hypertension_data <- diabetes_dataset %>%
  filter(smoking_history != 'No Info') %>%  
  group_by(smoking_history, hypertension) %>%  
  summarise(total = n())
smoking_hypertension_data

smoking_hypertension_percentage <- inner_join(smoking_tally, smoking_hypertension_data, by = 'smoking_history') %>% mutate(Percentage = round( total/total_people *100, digits = 2)) %>% select(smoking_history, hypertension, total, Percentage)

smoking_hypertension_percentage
```






```{r}

library(ggplot2)


df_male <- diabetes_dataset %>% 
  filter(gender == "Male") %>% 
  mutate(diabetes = factor(diabetes,
                           levels = c(0,1),
                           labels = c("Non‑diabetic","Diabetic")))

ggplot(df_male, aes(x = age, fill = diabetes)) +
  geom_density(alpha = 0.5) +
  scale_fill_manual(
    name   = "Diabetes status",
    values = c("Non‑diabetic" = "lightpink", 
               "Diabetic"     = "#301934")
  ) +
  labs(
    title = "Age Distribution in Male Subjects",
    x     = "Age",
    y     = "Density"
  ) +
  theme_minimal()

```

