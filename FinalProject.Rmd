---
title: "FinalProject"
output: html_document
date: "2025-04-10"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(ggplot2)
library(plotly)

```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r Loading in Data}
library(readr)
diabetes_dataset <- read_csv("diabetes_prediction_dataset.csv")
View(diabetes_dataset)

```

## Including Plots

You can also embed plots, for example:

```{r}
diabetes_dataset
# male datatset
male_data = diabetes_dataset %>% filter(gender == "Male")
# female dataset
female_data = diabetes_dataset %>% filter(gender == "Female")
female_data

# males and females within original dataset that have a "normal" A1C

female_data %>% filter(HbA1c_level <= 5.7) %>% tally()
male_data %>% filter(HbA1c_level <= 5.7) %>% tally()

# count of people (male and female) with both heart disease and diabetes

diabetes_dataset %>% filter(diabetes == 1, heart_disease == 1)
diabetes_dataset %>% filter(diabetes == 1, heart_disease == 1) %>% tally() # this is saying how many rows are in the data group and tally ***

# count of overweight people based on bmi who have heart disease
diabetes_dataset %>% group_by(bmi >= 30) %>% filter(heart_disease == 1)
diabetes_dataset %>% group_by(bmi >= 30) %>% filter(heart_disease == 1) 


# "obese men" with bmi higher than 30 and that have diabetes (tally on second line)
male_data %>% filter(bmi >= 30, diabetes == 1)
male_data %>% filter(bmi >= 30, diabetes == 1) %>% tally()
# "obese women" with bmi higher than 30 and that have diabetes (tally on second line)
female_data %>% filter(bmi >= 30, diabetes == 1)
female_data %>% filter(bmi >= 30, diabetes == 1) %>% tally() # grouped by gender ***
# "underweight men"  with bmi lower than 19 and that have diabetes (tally on second line)
male_data %>% filter(bmi <= 19, diabetes == 1)
male_data %>% filter(bmi <= 19, diabetes == 1) %>% tally()
# "underweight women"  with bmi lower than 19 and that have diabetes (tally on second line)
female_data %>% filter(bmi <= 19, diabetes == 1)
female_data %>% filter(bmi <= 19, diabetes == 1) %>% tally()
# the assumption is that overweight people are more likely to have diabetes. Below is the code and tally of MEN who are overweight in terms of bmi and DONT have diabetes
male_data %>% filter(bmi >= 30, diabetes == 0)
male_data %>% filter(bmi >= 30, diabetes == 0) %>% tally()
# the assumption is that overweight people are more likely to have diabetes. Below is the code and tally of WOMEN who are overweight in terms of bmi and DONT have diabetes
female_data %>% filter(bmi >= 30, diabetes == 0)
female_data %>% filter(bmi >= 30, diabetes == 0) %>% tally()

```



```{r}
library(dplyr)
library(ggplot2)
library(plotly)

# Compute percentages
HbA1c_counts <- HbA1c_by_gender %>%
  count(gender, HbA1c_category) %>%
  group_by(gender) %>%
  mutate(percent = n / sum(n) * 100)  # Compute percentage

# Create stacked bar plot with percentage labels
HbA1c_counts_plotly <- ggplot(HbA1c_counts, aes(x = gender, y = n, fill = HbA1c_category)) +
  geom_bar(stat = "identity", position = "fill", color = "black", linewidth = 0.2) +
  geom_text(aes(label = paste0(round(percent, 1), "%")), 
            position = position_fill(vjust = 0.5)) +
  scale_fill_manual(values = c("Normal < 5.7%" = "cornsilk2", 
                               "Prediabetes 5.7% - 6.4%" = "darkkhaki", 
                               "Diabetes ≥ 6.5%" = "darkgoldenrod")) +
  labs(title = "Male vs. Female Blood Sugar Levels (HbA1c)", 
       x = "Gender", y = "Proportion", fill = "HbA1c Category") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5))

ggplotly(HbA1c_counts_plotly)
```


Shows the distribution of BMI values based on hypertension status. A violin plot is great for visualizing the distribution and density of BMI across hypertension categories, 

Shape and width: The width of each "violin" represents the density of BMI values at different levels. Wider sections mean more individuals have that BMI, while narrower sections indicate fewer people at those values.

Comparison of distributions: The blue violin represents people without hypertension (hypertension = 0), while the red violin represents those with hypertension (hypertension = 1). By comparing them, you can see how BMI differs between these groups.

The horizontal line around 25 BMI: This marks the median BMI for each group. Since both violins have a horizontal line in roughly the same position, it suggests that the median BMI is around 25 for both hypertensive and non-hypertensive individuals.

Density trends: If the violins have different thicknesses in certain BMI ranges, it tells you which BMI values are more or less common in each group.
People with hypertension seem to have a higher BMI overall, but both groups share a similar median.

The distribution shape is different—for example, if one violin is wider at higher BMI values, it suggests that hypertension is more common among individuals with higher BMI.

Outliers or extreme values might appear as small bulges or extended tails at the ends of the violins, showing individuals with very high or low BMI.

```{r}
overall_median_bmi <- median(diabetes_dataset$bmi, na.rm = TRUE)

BMI_distribution <- ggplot(diabetes_dataset, aes(x = factor(hypertension), y = bmi, fill = factor(hypertension))) +
  geom_violin(alpha = 0.5) +
  geom_hline(yintercept = overall_median_bmi, linetype = "solid", color = "red", size = 0.2) +
  scale_fill_manual(values = c("cornflowerblue", "darkred"), labels = c("No Hypertension", "Hypertension")) +
  labs(title = "BMI Distribution by Hypertension Status",
       x = "Hypertension Status (0 = No, 1 = Yes)",
       y = "BMI",
       fill = "Hypertension") +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5))

ggplotly(BMI_distribution)
```


Here I'll leave extra info for you guys regarding the gender column of the original data set

```{r}
diabetes_dataset %>% filter(gender == 'Female') %>% tally # 58,552 we have 17,122 more females than males in this data set
diabetes_dataset %>% filter(gender == 'Male') %>% tally   # 41,430	
diabetes_dataset %>% filter(gender == 'Other') %>% tally  # 18	
```

```{r}
#BMI (Body Mass Index) is closely related to hypertension. Studies show that obesity is a major risk factor for high blood pressure, with around 65% to 78% of primary hypertension cases being linked to excess weigh

ggplot(diabetes_dataset, aes(x = hypertension, fill = bmi)) +
  geom_density(alpha = 0.5) +
  labs(title = "BMI Distribution by Hypertension Status", x = "BMI", y = "Hypertension")

diabetes_dataset %>% select(hypertension) %>%  filter(hypertension != 1 & 0)

hypertension_vs_bmi <- HbA1c_by_gender %>%
  mutate(hypertension_vs_bmi = factor(hypertension, levels = c("yes", "no")))
hypertension_vs_bmi
ggplot(hypertension_vs_bmi) + geom_density(aes(x = bmi , color = hypertension),alpha = .6)
```

```{r}
#diabetes_dataset %>% ggplot(aes(x=bmi)) + geom_point()
```

# Smokers go brrr

In the smoking data there are 6 unique values

1)  Never: Has Never smoked
2)  Not current: Has smoked but is not currently smoking
3)  Former: Has quit smoking (abstained for longer than)
4)  Current: Is currently a smoker
5)  Ever: Has ever smoked regardless of current smoking status
6)  No Info: No smoking history information available

The total amount of people who fall into each category is as follows;

1)  Never: 35095
2)  Not current: 6447
3)  Former: 9352
4)  Current: 9286
5)  Ever: 4004
6)  No Info: 35816

There is quite a sizable amount of people in the No info category.

The total number of people in the dataset is `r nrow(diabetes_dataset)`. To help clean up the data, we can filter 'No Info' people out. When we do that we get `r nrow(diabetes_dataset %>% filter(smoking_history != 'No Info'))`.

```{r Cleaning smoking data}

# Figure out the unique categories of smoking history 
unique(diabetes_dataset$smoking_history)

# Count amount of people who belong to each unique category
diabetes_dataset %>% group_by(smoking_history) %>% summarise(total_people = n())

smoking_diabetes_dataset <- diabetes_dataset %>% 
  filter(smoking_history != 'No Info') %>%  
  group_by(smoking_history, diabetes) %>%  
  summarise(total = n())
```

Now we can graph the relationship between

```{r Plotting data}

print('hello world')

```
