---
title: "Adam_Section_Go_Brrr"
output: ioslides_presentation
date: "2025-04-18"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)

library(tidyverse)
library(ggplot2)

```

One of the more interesting bits of data is that there are individuals that have an a1c of over 6.5 yet are not considered diabetic.

```{r hbA1C vs Blood Sugar}

```


```{r Blood_Glucose_level Data}

```


# Smokers go brrr# Smokers go brrrgeom_boxplot()

In the smoking data there are 6 unique values

1)  Never: Has Never smoked
2)  Not current: Has smoked but is not currently smoking
3)  Former: Has quit smoking (abstained for longer than)
4)  Current: Is currently a smoker
5)  Ever: Has ever smoked regardless of current smoking status
6)  No Info: No smoking history information available

The total amount of people who fall into each category is as follows;

1)  Never: 35095
2)  Not current: 6447
3)  Former: 9352
4)  Current: 9286
5)  Ever: 4004
6)  No Info: 35816

There is quite a sizable amount of people in the No info category.

The total number of people in the dataset is `r nrow(diabetes_dataset)`. To help clean up the data, we can filter 'No Info' people out. When we do that we get `r nrow(diabetes_dataset %>% filter(smoking_history != 'No Info'))`.

```{r Cleaning smoking data}

# Figure out the unique categories of smoking history
unique(diabetes_dataset$smoking_history)

# Count amount of people who belong to each unique category
xyz <- diabetes_dataset %>% filter(smoking_history != 'No Info') %>%  group_by(smoking_history) %>% summarise(total_people = n())

#group diabetic vs non diabetic people together
smoking_diabetes_dataset <- diabetes_dataset %>%
  filter(smoking_history != 'No Info') %>%  
  group_by(smoking_history, diabetes) %>%  
  summarise(total = n())

smoking_diabetes_dataset

smoking_data_Percentage <- inner_join(xyz, smoking_diabetes_dataset, by = 'smoking_history') %>% mutate(Percentage = total/total_people *100) %>% select(smoking_history, diabetes, total, Percentage)
```

Now we can graph the relationship between smoking and diabetes as separated by smoking category.

```{r Plotting smoking data}
library(ggplot2)
adams_first_graph <- ggplot(smoking_diabetes_dataset) + geom_col(aes(x = smoking_history, y = total, fill = as.factor(diabetes)), position = 'dodge')

smoking_diabetes_graph <- adams_first_graph + coord_flip() + labs(
  title = 'Smoking History and Diabetes Relationship',
  x = 'People',
  y = 'Smoking History',
  fill = 'Has Diabetes',
  caption = "1 indicates diabetes, 0 indicates no diabetes"
)

smoking_diabetes_graph
```
```{r Smoking on that percentage pack tonight tonight}
smoking_data_Percentage

ggplot(smoking_data_Percentage, aes(smoking_history, Percentage, colour = as.factor(diabetes))) + geom_count()
```


```{r heart disease and smoking}
smoking_heart_disease_dataset <- diabetes_dataset %>%
  filter(smoking_history != 'No Info') %>%  
  group_by(smoking_history, heart_disease) %>%  
  summarise(total = n())
smoking_heart_disease_dataset
```