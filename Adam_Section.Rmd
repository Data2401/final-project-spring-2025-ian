---
title: "Adams Section"
output: slidy_presentation
date: "April 20, 2025"
---



```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)

library(tidyverse)
library(ggplot2)
library(scales)
library(plotly)

library(readr)
diabetes_dataset <- read_csv("diabetes_prediction_dataset.csv")

```

## Smokers go brrr

In the smoking data there are 6 unique values

1)  Never: Has Never smoked
2)  Not current: Has smoked but is not currently smoking
3)  Former: Has quit smoking (abstained for longer than)
4)  Current: Is currently a smoker
5)  Ever: Has ever smoked regardless of current smoking status
6)  No Info: No smoking history information available


The total amount of people who fall into each category is as follows;

1)  Never: 35095
2)  Not current: 6447
3)  Former: 9352
4)  Current: 9286
5)  Ever: 4004
6)  No Info: 35816
---
There is quite a sizable amount of people in the No info category.

The total number of people in the dataset is `r nrow(diabetes_dataset)`. To help clean up the data, we can filter 'No Info' people out. When we do that we get `r nrow(diabetes_dataset %>% filter(smoking_history != 'No Info'))`.

```{r Cleaning smoking data}

# Figure out the unique categories of smoking history
#unique(diabetes_dataset$smoking_history)

# Count amount of people who belong to each unique smoking category
#Omit No info

smoking_tally <- diabetes_dataset %>% filter(smoking_history != 'No Info') %>%  group_by(smoking_history) %>% summarise(total_people = n())
```

# Sumarizing diabetes and smoking history

The data was then summarized to gather the total counts belonging to each smoking category and further grouped by diabetes status.

A percentage per smoking category with diabetes is then calculated dividing the count with diabetes by the total count in each smoking category.

```{r smoking and diabetes}
#group diabetic vs non diabetic people together

smoking_diabetes_dataset <- diabetes_dataset %>%
  filter(smoking_history != 'No Info') %>%  
  group_by(smoking_history, diabetes) %>%  
  summarise(total = n())

smoking_diabetes_dataset

# Inner join tally data with diabetic grouped data;
#mutate a column to create a percentage per category;
#select desired columns

smoking_diabetes_percentage <- inner_join(smoking_tally, smoking_diabetes_dataset, by = 'smoking_history') %>% mutate(Percentage = total/total_people) %>% select(smoking_history, diabetes, total, Percentage)

smoking_diabetes_percentage
```
# Graphing

Now we can graph the relationship between smoking and diabetes as separated by smoking category.

```{r Plot smoking and diabetes}

#Create initial graph about smoking and diabetes

smoking_diabetes_graph <- ggplot(smoking_diabetes_percentage,
       aes(x    = smoking_history,
           y    = total,
           fill = factor(diabetes))) +
  geom_col(position = position_dodge(width = 0.9)) +
 
  # add percent labels
  geom_text(aes(label = percent(Percentage, accuracy = .1)),
            position = position_dodge(width = 1),
            vjust    = .4,        # nudge above bar
            size     = 3,
            hjust    = -.1) +
            
 
  coord_flip() +
  scale_y_continuous(expand = expansion(mult = c(0, .1))) +
  labs(
    title   = "Smoking History and Diabetes Relationship",
    x       = "Smoking History",
    y       = "Count of People",
    fill    = "Has Diabetes",
    caption = "1 = diabetes, 0 = no diabetes"
  ) 

smoking_diabetes_graph

```


# Heart disease and smoking

The methods used to summarise the diabetes and smoking history data are repeated with the heart disease column.

```{r heart disease and smoking}
smoking_heart_disease_data <- diabetes_dataset %>%
  filter(smoking_history != 'No Info') %>%  
  group_by(smoking_history, heart_disease) %>%  
  summarise(total = n())

smoking_heart_disease_percentage <- inner_join(smoking_tally, smoking_heart_disease_data, by = 'smoking_history') %>% mutate(Percentage = round( total/total_people, digits = 4)) %>% select(smoking_history, heart_disease, total, Percentage)

smoking_heart_disease_percentage

```


# Graphing relationship of Smoking History and Heart Disease

```{r Heart Disease and Smoking Graph}
smoking_heart_disease_graph <- ggplot(smoking_heart_disease_percentage,
       aes(x    = smoking_history,
           y    = total,
           fill = factor(heart_disease))) +
  geom_col(position = position_dodge(width = 0.9)) +
 
  # add percent labels
  geom_text(aes(label = percent(Percentage, accuracy = .1)),
            position = position_dodge(width = 1),
            vjust    = .4,        # nudge above bar
            size     = 3,
            hjust    = -.1) +
            
 
  coord_flip() +
  scale_y_continuous(expand = expansion(mult = c(0, .1))) +
  labs(
    title   = "Smoking History and Heart Disease Relationship",
    x       = "Smoking History",
    y       = "Count of People",
    fill    = "Has Heart Disease",
    caption = "1 = Heart Disease, 0 = No Heart Disease"
  ) 

smoking_heart_disease_graph
```

# Smoking and Hypertension

Once again, the same methods applied to diabetes and heart disease was applied to Hypertension.

```{r Smoking and hypertension}
smoking_hypertension_data <- diabetes_dataset %>%
  filter(smoking_history != 'No Info') %>%  
  group_by(smoking_history, hypertension) %>%  
  summarise(total = n())

smoking_hypertension_percentage <- inner_join(smoking_tally, smoking_hypertension_data, by = 'smoking_history') %>% mutate(Percentage = round( total/total_people, digits = 4)) %>% select(smoking_history, hypertension, total, Percentage)

smoking_hypertension_percentage
```

#Graphing Smoking history and Hypertension


```{r Smoking and Hypertension Graph}
smoking_hypertension_graph <- ggplot(smoking_hypertension_percentage,
       aes(x    = smoking_history,
           y    = total,
           fill = factor(hypertension))) +
  geom_col(position = position_dodge(width = 0.9)) +
 
  # add percent labels
  geom_text(aes(label = percent(Percentage, accuracy = .1)),
            position = position_dodge(width = 1),
            vjust    = .4,        # nudge above bar
            size     = 3,
            hjust    = -.1) +
            
 
  coord_flip() +
  scale_y_continuous(expand = expansion(mult = c(0, .1))) +
  labs(
    title   = "Smoking History and Hypertension Relationship",
    x       = "Smoking History",
    y       = "Count of People",
    fill    = "Has Hypertension",
    caption = "1 = Hypertension, 0 = No Hypertension"
  ) 

smoking_hypertension_graph

```


# Age as a factor

When looking at the data, there is a spike in former smokers risk for the three health issues discussed.

Questions arose; If you never quit smoking, do you maintain similar risk to people who never have smoked? What changes from current to former smokers?

To have been classified a former smoker, you at one point had to have been a current smoker; which signifies a change in age from current to former smoking status.

This lead to me graphing the density of smoking category by age.

# Age and Smoking History Category

```{r Age by smoking category}

smoking_data <- diabetes_dataset %>% filter(smoking_history != "No Info")

ggplot(smoking_data, aes(x = age, color = as.factor(smoking_history))) + geom_density()
       
       
```

# The Age and Health Factors

The data shows a increase in former smokers with a simultaneous decrease in current smokers around the 40-60 yr age range.

We can compare this with the density of people with diabetes, hypertension, and heart disease across all ages to see if there are similar spikes.



```{r Age and health issues}

age_vs_diabetes <- ggplot(diabetes_dataset, aes(x = age, color = as.factor(diabetes))) + geom_density()

age_vs_hypertension <- ggplot(diabetes_dataset, aes(x = age, color = as.factor(hypertension))) + geom_density()

age_vs_heart_disease <- ggplot(smoking_data, aes(x = age, fill = as.factor(heart_disease))) + geom_density(alpha = .5)

age_vs_diabetes
```



```{r age vs heart disease}
age_vs_heart_disease

```



```{r age vs hypertension}
age_vs_hypertension

```

# Findings

Former smokers are at a higher risk for diabetes, hypertension, and heart disease

As people get older, their risk for disease increases

Although current smokers risk is not reflected through our percentage graph, further digging shows that around the age where current smokers decrease and former smokers increase is around the same age range that the risk for disease increases

