---
title: "FinalProject"
output: html_document
date: "2025-04-10"
---

```{r setup, include=FALSE, echo = FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(ggplot2)

```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r}
library(ggplot2)

ggplot(smoking_diabetes_percentage) + geom_col(aes(x = smoking_history, y = Percentage, fill = as.factor(diabetes)))
smoking_diabetes_percentage



library(ggplot2)

smoking_diabetes_per <- smoking_diabetes_percentage %>% select(smoking_history,diabetes,total) %>% mutate(diabetes = factor(diabetes, levels = c(0, 1), labels = c("No Diabetes", "Diabetes"))) 
smoking_diabetes_per

smoking_diabetes_per <- smoking_diabetes_per %>%
  group_by(smoking_history) %>%  # Group by smoking category
  mutate(Percentage = total / sum(total) * 100) 

ggplot(smoking_diabetes_per, aes(x = smoking_history, y = Percentage, fill = diabetes)) +
  geom_col(position = "stack") +
  geom_text(aes(label = paste0(round(Percentage, 1), "%")),
            position = position_stack(vjust = 0.5), size = 4) +
  labs(title = "Smoking History and Diabetes Status",
       x = "Smoking History",
       y = "Total Count",
       fill = "Diabetes Status") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))  # Rotate x-axis for better readability



library(dplyr)
library(ggplot2)
library(plotly)


smoking_diabetes_per <- smoking_diabetes_percentage %>% select(smoking_history,diabetes,total, Percentage) %>% mutate(diabetes = factor(diabetes, levels = c(0, 1), labels = c("No Diabetes", "Diabetes"))) 
smoking_diabetes_per

ggplot(smoking_diabetes_per, aes(x = smoking_history, y = Percentage, fill = diabetes)) +
  geom_col(position = "stack") +
  labs(title = "Smoking History and Diabetes Status",
       x = "Smoking History",
       y = "Total Count",
       fill = "Diabetes Status") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))  # Rotate x-axis for better readability



ggplot(smoking_diabetes_percentage, aes(x = smoking_history, y = Percentage, fill = diabetes)) +
  geom_col(position = "stack") +
  geom_text(aes(label = paste0(round(Percentage, 1), "%")), 
            position = position_stack(vjust = 0.5), size = 4) +  # Centers text inside bars
  labs(title = "Smoking History and Diabetes Status",
       x = "Smoking History",
       y = "Percentage (%)",
       fill = "Diabetes Status") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))  # Rotate x-axis labels for readability


library(dplyr)
library(ggplot2)
library(plotly)


x <- ggplot(smoking_diabetes_per, aes(x = smoking_history, y = Percentage, fill = diabetes)) +
  geom_col(position = "stack") +
  geom_text(aes(label = paste0(round(Percentage, 1), "%")), 
            position = position_stack(vjust = 0.5), size = 4) +  # Centers text inside bars
  labs(title = "Smoking History and Diabetes Status",
       x = "Smoking History",
       y = "Percentage (%)",
       fill = "Diabetes Status") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))  # Rotate x-axis labels for readability


ggplotly(x)

```
```{r}
diabetes_dataset %>% select(diabetes, blood_glucose_level) %>% filter(diabetes == 0, blood_glucose_level == 201)
```

```{r}
#missing part
library(dplyr)
library(ggplot2)
library(plotly)
library(knitr) 

HbA1c_by_gender <- diabetes_dataset %>% filter(gender != 'Other') %>% 
  mutate(HbA1c_category = case_when(
    HbA1c_level < 5.7 ~ "Normal < 5.7%",
    HbA1c_level >= 5.7 & HbA1c_level < 6.5 ~ "Prediabetes 5.7% - 6.4%",
    HbA1c_level >= 6.5 ~ "Diabetes ≥ 6.5%",
    TRUE ~ NA_character_  # handles unexpected cases that don’t match the defined conditions keeping missing values as NA
    ))

HbA1c_by_gender <- HbA1c_by_gender %>%
  mutate(HbA1c_category = factor(HbA1c_category, levels = c("Normal < 5.7%", "Prediabetes 5.7% - 6.4%", "Diabetes ≥ 6.5%")))

# here we print out our mutated dataset to make a comparison of the original.
#HbA1c_by_gender
kable(head(HbA1c_by_gender, 6), caption = "99,982 × 10 (first 6 rows)")
```


```{r}
# Compute percentages
HbA1c_counts <- HbA1c_by_gender %>%
  count(gender, HbA1c_category) %>%
  group_by(gender) %>%
  mutate(percent = n / sum(n) * 100)  # Compute percentage

# Create stacked bar plot with percentage labels
HbA1c_counts_plotly <- ggplot(HbA1c_counts, aes(x = gender, y = n, fill = HbA1c_category)) +
  geom_bar(stat = "identity", position = "fill", color = "black", linewidth = 0.1, alpha = 0.5) +
  geom_text(aes(label = paste0(round(percent, 1), "%")), 
            position = position_fill(vjust = 0.5)) +
  scale_fill_manual(values = c("Normal < 5.7%" = "cornsilk", 
                               "Prediabetes 5.7% - 6.4%" = "darkkhaki", 
                               "Diabetes ≥ 6.5%" = "darkgoldenrod4")) +
  labs(title = "Male vs. Female Blood Sugar Levels (HbA1c)", 
       x = "Gender", y = "Proportion", fill = "HbA1c Category") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5))+
  theme(
    plot.title = element_text(size = 13),
    axis.text = element_text(size = 11),
  )

ggplotly(HbA1c_counts_plotly)
```


```{r}
# I select, filter, and mutate the columns I want to work with 

mut_diabdat_for_BSL <- diabetes_dataset %>%
  select(gender, diabetes, HbA1c_level) %>%
  filter(gender != "Other") %>%       # we want to focus on male and female only
  mutate(HbA1c_category = case_when(  # categorize diabetes status based on BSL
    HbA1c_level < 5.7 ~ "Normal < 5.7%",
    HbA1c_level >= 5.7 & HbA1c_level <= 6.4 ~ "Prediabetic 5.7% - 6.4%",
    HbA1c_level >= 6.5 ~ "Diabetic ≥ 6.5%"
  ))
mut_diabdat_for_BSL

# I count, group_by, and mutate to obtain the number and percentage for each diabetic category for M and F

get_perc_count <- mut_diabdat_for_BSL %>% 
  count(gender, HbA1c_category) %>%  # new count col of the number of people within each category for M and F
  group_by(gender) %>%   # group by gender
  mutate(percent = n / sum(n) * 100) # get percentage of population within each diabetic category
get_perc_count

# I create my barplot, add x and y labels as well as color and text details. 

get_perc_count_plotly <- ggplot(get_perc_count, aes(x = gender, y = n, fill = HbA1c_category)) +
  geom_bar(stat = "identity", position = "fill", color = "black", linewidth = 0.1, alpha = 0.5) + 
  geom_text(aes(label = paste0(n, " (", round(percent, 1), "%)")),
            position = position_fill(vjust = 0.5), size = 3) +
  scale_fill_manual(values = c("Normal < 5.7%" = "cornsilk2", 
                               "Prediabetic 5.7% - 6.4%" = "darkkhaki", 
                               "Diabetic ≥ 6.5%" = "darkgoldenrod4")) +
  labs(title = "Male vs. Female Blood Sugar Levels (HbA1c)", 
       x = "Gender", y = "Proportion", fill = "HbA1c Category") +
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5))+
  theme(
    plot.title = element_text(size = 13),
    axis.text = element_text(size = 11),
  )

# I finally make the bar plot interactive using ggplotly

ggplotly(get_perc_count_plotly)
```


## Including Plots

```{r echo = FALSE}
diabetes_dataset
# male datatset
male_data = diabetes_dataset %>% filter(gender == "Male")
# female dataset
female_data = diabetes_dataset %>% filter(gender == "Female")
female_data

# males and females within original dataset that have a "normal" A1C

female_data %>% filter(HbA1c_level <= 5.7) %>% tally()
male_data %>% filter(HbA1c_level <= 5.7) %>% tally()

# count of people (male and female) with both heart disease and diabetes
diabetes_dataset %>% filter(diabetes == 1, heart_disease == 1) # this is saying how many rows are in the data group and tally ***
# count of overweight people based on bmi who have heart disease
diabetes_dataset %>% group_by(bmi >= 30) %>% filter(heart_disease == 1)
diabetes_dataset %>% group_by(bmi >= 30) %>% filter(heart_disease == 1) 


# "obese men" with bmi higher than 30 and that have diabetes (tally on second line)
male_data %>% filter(bmi >= 30, diabetes == 1)
male_data %>% filter(bmi >= 30, diabetes == 1) %>% tally()
# "obese women" with bmi higher than 30 and that have diabetes (tally on second line)
female_data %>% filter(bmi >= 30, diabetes == 1)
female_data %>% filter(bmi >= 30, diabetes == 1) %>% tally() # grouped by gender ***
# "underweight men"  with bmi lower than 19 and that have diabetes (tally on second line)
male_data %>% filter(bmi <= 19, diabetes == 1)
male_data %>% filter(bmi <= 19, diabetes == 1) %>% tally()
# "underweight women"  with bmi lower than 19 and that have diabetes (tally on second line)
female_data %>% filter(bmi <= 19, diabetes == 1)
female_data %>% filter(bmi <= 19, diabetes == 1) %>% tally()
# the assumption is that overweight people are more likely to have diabetes. Below is the code and tally of MEN who are overweight in terms of bmi and DONT have diabetes
male_data %>% filter(bmi >= 30, diabetes == 0)
male_data %>% filter(bmi >= 30, diabetes == 0) %>% tally()

# the assumption is that overweight people are more likely to have diabetes. Below is the code and tally of WOMEN who are overweight in terms of bmi and DONT have diabetes
female_data %>% filter(bmi >= 30, diabetes == 0)
female_data %>% filter(bmi >= 30, diabetes == 0) %>% tally()
```


Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

In this section we want to display a stack bar showing how HbA1c levels (average blood sugar levels) can classify Males and Females in different categories such as Normal, Prediabetes, and Diabetes. From this plot we gain insight on how the distribution of Normal, Prediabetes, and Diabetes varies between both genders.

First we load our libraries such as dplyr for data manipulation, ggplot2 for data visualization, and plotly to make our plot interactive. Then we we display our original dataset.

From our original data set we create a new dataset called HbA1c_by_gender. For our new dataset we want to keep only the Male and Female gender and exclude Other, the way to do this is by filtering our gender column to not equal to 'Other'. We also create a new variable called HbA1c_category with the use of our mutate function. We use the case_when function to classify our HbA1c_level column and return different categories such as 'Normal', 'Prediabetes', and 'Diabetes'.

Then we print out our mutated dataset to make a comparison of the original.

In the next section we want our stack bar to follow a certain order, we want Normal at the top, Prediabetes at the middle, and Diabetes at the bottom. To do this we will mutate our HbA1c_category column to an ordered categorical variable with the use of the factor function, the levels argument helps to set the order we want.

Next, we will plot a stack bar using ggplot. Before that we will change the name of our data set to 'Interactive_mode' that way we can easily incorporate our data set to ggplotly. The scale_fill_manual function is used to manually assign colors to the different categories.

Lastly, with the use of plotly we transform our plot into an interactive plot. When approaching the table we are able to see the count, gender, and HbA1c_category for any of the stacked bars.

```{r echo = FALSE}

# feedback from shooe maker mesage = False
# hide code for the presenatation
#keep infor
#smoking hist should be a factor
# do posittion = fill lets you coount in proportions
```



```{r}
library(ggplot2)

# Example dataset (replace with actual data)
data <- data.frame(
  gender = factor(rep(c("Male", "Female", "Other"), each = 50)),
  bmi = c(runif(50, 18, 40), runif(50, 18, 40), runif(50, 18, 40)), 
  diabetes = factor(sample(c("Yes", "No"), 150, replace = TRUE))
)

# Creating the plot
ggplot(data, aes(x = gender, y = bmi, fill = diabetes)) +
  geom_boxplot() +
  labs(title = "BMI Distribution by Gender and Diabetes Status",
       x = "Gender",
       y = "BMI") +
  theme_minimal()
```



```{r}
# here I'll leave extra info for you guys regarding the gender column of the original data set
diabetes_dataset %>% filter(gender == 'Female') %>% tally # 58,552 we have 17,122 more females than males in this data set
diabetes_dataset %>% filter(gender == 'Male') %>% tally   # 41,430	
diabetes_dataset %>% filter(gender == 'Other') %>% tally  # 18	
# check why most ppl dont have 5.3 because we are working with a bunch of ppl ****
# turn heart disease into a category
# when we graph we see that this data may not be legit bc ppl who are older that 80 seem to be pushed out 
```


```{r}
library(dplyr)
library(ggplot2)
library(scales)

diabetes_dataset %>%
  filter(age >= 3) %>%  # Ensure ages 3-80 are included
  select(age, diabetes, heart_disease) %>%
  pivot_longer(cols = c(diabetes, heart_disease), names_to = "condition", values_to = "status") %>%
  filter(status == 1) %>%  # Keep only cases where the condition is present
  ggplot(aes(x = age, fill = condition)) +
  geom_density(alpha = 0.6, adjust = 1.5) +
  scale_x_continuous(limits = c(3, 80), breaks = seq(3, 80, by = 7)) +
  scale_y_continuous(labels = scales::percent_format(scale = 1)) +  # Show density as percentages
  scale_fill_manual(values = c("red", "purple"), labels = c("Diabetes", "Heart Disease")) +
  labs(title = "Density of Diabetes & Heart Disease Across Age Groups",
       x = "Age", y = "Percentage Density", fill = "Condition") +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5))

diabetes_dataset
diabetes_dataset %>% select(age, diabetes, heart_disease) %>%  filter(age >= 3, diabetes == 1, heart_disease == 1) %>% arrange(age) %>%  ggplot(aes(x = age)) +
  geom_density(alpha = 0.6, adjust = 1.5) +
   theme_minimal()
```


```{r}
diabetes_dataset

diabetes_only <- diabetes_dataset %>% select(age, diabetes) %>%  filter(age >= 2, diabetes == 1)
heart_disease_only <- diabetes_dataset %>% select(age,heart_disease) %>% filter(age >= 2, heart_disease == 1)
bmi_older_than_two <- diabetes_dataset %>% select(age, bmi) %>% filter(age >= 2)

ggplot() +
  geom_density(data = diabetes_only, aes(x = age), fill = "blue", alpha = 0.5) +  # Diabetes cases
  geom_density(data = heart_disease_only, aes(x = age), fill = "red", alpha = 0.5) + # Heart disease only
  geom_density(data = bmi_older_than_two, aes(x = age), fill = "magenta", alpha = 0.5) +  
  labs(title = "Age Distribution: Diabetes vs. Heart Disease",
       x = "Age",
       y = "Density") +
  theme_minimal() 
```

### how is heart_disease, blood_glucose and diabetes related

```{r}
diabetes_dataset

diabetes_only <- diabetes_dataset %>% select(age, diabetes) %>%  filter(age >= 2, diabetes == 1)
heart_disease_only <- diabetes_dataset %>% select(age,heart_disease) %>% filter(age >= 2, heart_disease == 1)
bmi_older_than_two <- diabetes_dataset %>% select(age, bmi) %>% filter(age >= 2)

ggplot() +
  geom_density(data = diabetes_only, aes(x = age), fill = "blue", alpha = 0.5) +  # Diabetes cases
  geom_density(data = heart_disease_only, aes(x = age), fill = "red", alpha = 0.5) + # Heart disease only
  #geom_density(data = bmi_older_than_two, aes(x = age), fill = "magenta", alpha = 0.5) +  
  labs(title = "Age Distribution: Diabetes vs. Heart Disease",
       x = "Age",
       y = "Density") +
  theme_minimal() 
```
```{r}
diabetes_dataset

diabetes_only <- diabetes_dataset %>% select(age, diabetes) %>%  filter(age >= 2, diabetes == 1)
heart_disease_only <- diabetes_dataset %>% select(age,heart_disease) %>% filter(age >= 2, heart_disease == 1)
former_smoker_only <- diabetes_dataset %>% select(age, smoking_history) %>%  filter(age >= 7, smoking_history == 'former')

ggplot() +
  geom_density(data = diabetes_only, aes(x = age), fill = "blue", alpha = 0.5) +  # Diabetes cases
  geom_density(data = heart_disease_only, aes(x = age), fill = "red", alpha = 0.5) + # Heart disease only
  labs(title = "Age Distribution: Diabetes vs. Heart Disease",
       x = "Age",
       y = "Density") +
  theme_minimal()

```

```{r}
diabetes_dataset
```


##################!!!!!!!!!!!!!!!!!!!!

```{r}
#diabetes_dataset %>% select(age, diabetes) %>% filter(diabetes == 1) %>% arrange(age)
# y: 3 o: 80
#diabetes_dataset %>% select(age,heart_disease) %>% filter(heart_disease == 1) %>% arrange(age)
# y: 2 o: 80
library(ggplot2)
library(dplyr)

diabetes_only <- diabetes_dataset %>% select(age, diabetes) %>%  filter(age >= 3, diabetes == 1)
heart_disease_only <- diabetes_dataset %>% select(age,heart_disease) %>% filter(age >= 2, heart_disease == 1)
former_smoker_only <- diabetes_dataset %>% select(age, smoking_history) %>%  filter(age >= 7, smoking_history == 'former')

ggplot() +
  geom_density(data = diabetes_only, aes(x = age), fill = "blue", alpha = 0.5) +  # Diabetes cases
  geom_density(data = heart_disease_only, aes(x = age), fill = "red", alpha = 0.5) + # Heart disease only
  geom_density(data = former_smoker_only, aes(x = age), fill = "cyan", alpha = 0.5) +
  labs(title = "Age Distribution: Diabetes vs. Heart Disease",
       x = "Age",
       y = "Density") +
  scale_x_continuous(breaks = seq(0, 80, by = 5)) +
  scale_y_continuous(breaks = seq(0.00, 0.07, by = 0.01)) +
  theme_bw()

```
```{r}
library(ggplot2)
library(dplyr)
library(plotly)

# show a density plot to display age distribution based on diabetes and heart disease
# I create 2 new variables based on my original data set, I select and filter the columns I want to work with

DHH_only <- diabetes_dataset %>% 
  select(age, diabetes, heart_disease, hypertension) %>%  
  filter(age >= 2, diabetes == 1, heart_disease == 1, hypertension == 1) %>%
  mutate(group = "Diabetes, H.D, and Hyp.")

kable(head(DHH_only, 5), caption = "358 x 5 (first 5 rows)")

No_DHH_only <- diabetes_dataset %>%
  select(age,heart_disease, diabetes, hypertension) %>%
  filter(age >= 2, diabetes == 0, heart_disease == 0, hypertension ==0) %>%
  mutate(group = "Free of Diabetes, H.D, and Hyp.")

kable(head(No_DHH_only, 5), caption = "81,885 x 5 (first 5 rows)")

# create the density plot, 
interactive_DHH <- ggplot() +
  geom_density(data = DHH_only, aes(x = age, fill = group), alpha = 0.5) +  # Diabetes cases
  geom_density(data = No_DHH_only , aes(x = age, fill = group), alpha = 0.5) +
  labs(title = "Age Distribution: Diabetes vs. Heart Disease",
       x = "Age",
       y = "Density") +
  scale_x_continuous(breaks = seq(2, 80, by = 6)) +
  scale_fill_manual(values = c("Diabetes, H.D, and Hyp." = "#660033",
                               "Free of Diabetes, H.D, and Hyp." = "#66CCFF")) +  # Custom colors
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5)) +
  theme(
    plot.title = element_text(size = 13),
    axis.text = element_text(size = 11),
  )

# here I make the bar plot interactive using ggplotly

ggplotly(interactive_DHH)
```

```{r}

DHH_only_y <- DHH_only %>%
  mutate(group = "Diab. + H.D + Hyp.")

No_DHH_only_y <- No_DHH_only %>%
  mutate(group = "No Diab., No H.D, No Hyp.")
interactive_DHH <- ggplot() +
  geom_density(data = DHH_only_y, aes(x = age, fill = group), alpha = 0.5) +  
  geom_density(data = No_DHH_only_y, aes(x = age, fill = group), alpha = 0.5) +
  labs(title = "Age Distribution: Diabetes vs. Heart Disease",
       x = "Age",
       y = "Density",
       fill = "Health Status") +  # Legend title
  scale_x_continuous(breaks = seq(2, 80, by = 6)) +
  scale_fill_manual(values = c("Diab. + H.D + Hyp." = "#660033",
                               "No Diab., No H.D, No Hyp." = "#66CCFF")) +  # Custom colors
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5),
        axis.text = element_text(size = 11)) 

# Make it interactive
ggplotly(interactive_DHH)


```


```{r}
library(ggplot2)
library(dplyr)

diabetes_only <- diabetes_dataset %>% select(age, diabetes) %>%  filter(age >= 3, diabetes == 1)
non_diabetes_only <- diabetes_dataset %>% select(age, diabetes) %>% filter(diabetes == 0, age >= 1)
heart_disease_only <- diabetes_dataset %>% select(age,heart_disease) %>% filter(age >= 2, heart_disease == 1)

ggplot() +
  geom_density(data = non_diabetes_only, aes(x = age), fill = "cyan", alpha = 0.5) + # Heart disease only 
  geom_density(data = heart_disease_only, aes(x = age), fill = "red", alpha = 0.5) +
  labs(title = "Age Distribution: Diabetes vs. Heart Disease",
       x = "Age",
       y = "Density") +
  scale_x_continuous(breaks = seq(0, 80, by = 6)) +
  scale_y_continuous(breaks = seq(0.00, 0.07, by = 0.01)) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))
```
```{r}
library(ggplot2)
library(dplyr)

diabetes_only <- diabetes_dataset %>% select(age, diabetes) %>%  filter(age >= 3, diabetes == 1)
non_diabetes_only <- diabetes_dataset %>% select(age, diabetes) %>% filter(diabetes == 0, age >= 1)
heart_disease_only <- diabetes_dataset %>% select(age,heart_disease) %>% filter(age >= 2, heart_disease == 1)

diabetes_dataset %>% select(age, diabetes, heart_disease) %>% filter(diabetes == 0, age >= 1, heart_disease == 1) %>% arrange(-age)
#y 2 o:80

diabetes_dataset %>% select(age, diabetes, heart_disease) %>% filter(diabetes == 0, age >= 1, heart_disease == 1) %>% arrange(-age)
```

#$$$$$$$$$$$$$$$$$$!!!!!!!!

```{r}
library(dplyr)
library(ggplot2)
library(plotly)

# these are the variables I worked with to create this table
table_diabetes_no_diabetes <- diabetes_dataset %>%
  select(blood_glucose_level,diabetes, age) %>%
  filter(age >= 3) %>% 
  mutate(diabetes = factor(diabetes, levels = c(0, 1), labels = c("No Diabetes", "Diabetes")))

# here I show the table
kable(head(table_diabetes_no_diabetes, 5), caption = "96,713 x 3 (first 5 rows)")

diabetes_and_no_diabetes_plot <- diabetes_dataset %>%
  select(blood_glucose_level,diabetes, age) %>%
  filter(age >= 3) %>% 
  mutate(diabetes = factor(diabetes, levels = c(0, 1), labels = c("No Diabetes", "Diabetes"))) %>% 
  ggplot(aes(x = diabetes, y = blood_glucose_level, fill = diabetes)) +
  geom_boxplot(alpha = 0.5) +
  labs(title = "Blood Glucose Levels by Diabetes Status (age 3-80)",
       x = "Diabetes Status",
       y = "Blood Glucose Level") +
  scale_fill_manual(values = c("Diabetes" = "#CC3300", "No Diabetes" = "#99CCFF")) +
  labs(fill = "Status") +
  scale_y_continuous(breaks = seq(80, 300, by = 20)) +
  geom_hline(yintercept = c(120, 140), linetype = "solid", color = "#0033FF", size = 0.2) +
  geom_hline(yintercept = c(180, 250), linetype = "solid", color = "#CC3300", size = 0.3) +  # Mark High Range
  theme_void() +
  theme(plot.title = element_text(hjust = 0.5))+
  theme(
    plot.title = element_text(size = 13),
    axis.text = element_text(size = 11),
  )

ggplotly(diabetes_and_no_diabetes_plot)
```

```{r}
library(dplyr)
library(ggplot2)
library(plotly)

diabetes_dataset

non_healthy_bl <- diabetes_dataset %>% select(blood_glucose_level,diabetes,age) %>% filter(age >= 3, diabetes == 1)
#h: 300   l: 126 

healthy_bl <- diabetes_dataset %>% select(blood_glucose_level,diabetes,age) %>% filter(age >= 3, diabetes == 0)
#h: 200  l: 80

```

```{r}
diabetes_dataset %>% select(bmi,hypertension) 
```


diabetes_dataset
mutat_Bmii <- diabetes_dataset %>% select(bmi, hypertension) %>% 
  mutate(hypertension_status = case_when(
    hypertension == 1 ~ "Yes",
    hypertension == 0 ~ "No",
    TRUE ~ NA_character_
  ))
  
mutat_Bmii_perc_count <- mutat_Bmii %>% 
  count(hypertension) %>% 
  group_by(hypertension) %>%  
  mutate(percent = n / sum(n) * 100)
mutat_Bmii_perc_count


mutat_Bmii <- diabetes_dataset %>% select(bmi, hypertension) %>% 
  mutate(hypertension_status = case_when(
    hypertension == 1 ~ "Yes",
    hypertension == 0 ~ "No",
    TRUE ~ NA_character_
  ))
mutat_Bmii
ggplot(mutat_Bmii, aes(x = factor(hypertension_status), y = bmi, fill = factor(hypertension_status)) +
  geom_violin(alpha = 0.7) +
  geom_hline(yintercept = overall_median_bmi, linetype = "solid", color = "red", linewidth = 0.3) +
  scale_fill_manual(values = c("azure3", "coral3")) +
  scale_y_continuous(breaks = seq(10.01, 95.69, by = 5)) +
  labs(title = "BMI Distribution by Hypertension Status",
       x = "Hypertension Status (0 = No, 1 = Yes)",
       y = "BMI",
       fill = "Hypertension") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))+
  theme(
    plot.title = element_text(size = 13),
    axis.text = element_text(size = 11),
  ))
  
class(mutat_Bmii$hypertension_status)

```{r, echo=FALSE,fig.width=7, fig.height=6, fig.align="center"}

diabetes_dataset

overall_median_bmi <- median(diabetes_dataset$bmi, na.rm = TRUE)

BMI_distribution <- ggplot(diabetes_dataset, aes(x = factor(hypertension), y = bmi, fill = factor(hypertension))) +
  geom_violin(alpha = 0.7) +
  geom_hline(yintercept = overall_median_bmi, linetype = "solid", color = "red", linewidth = 0.3) +
  scale_fill_manual(values = c("azure3", "coral3")) +
  scale_y_continuous(breaks = seq(10.01, 95.69, by = 5)) +
  labs(title = "BMI Distribution by Hypertension Status",
       x = "Hypertension Status (0 = No, 1 = Yes)",
       y = "BMI",
       fill = "Hypertension") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))+
  theme(
    plot.title = element_text(size = 13),
    axis.text = element_text(size = 11),
  )

ggplotly(BMI_distribution)
```


```{r, echo=FALSE, message=FALSE, warning=FALSE, fig.width=10, fig.height=6, fig.align="center"}
library(dplyr)
library(ggplot2)
library(knitr) 

#diabetes_dataset_filtered_bmi <- diabetes_dataset %>%
 # mutate(bmi_filtered = ifelse(bmi >= 2, bmi, NA))
diabetes_dataset

# here I create 2 variables that represent the data frames I'll be working on 
diabetes_onlyyy <- diabetes_dataset %>%
  select(age, bmi, diabetes) %>%
  filter(age >= 2, diabetes == 1) %>%
  mutate(condition = "Diabetes Only")

# here is a demonstration of the diabetes_only data frame
kable(head(diabetes_only, 5), caption = "8,500 x 4 (first 5 rows)")

heart_disease_onlyyy <- diabetes_dataset %>%
  select(age, bmi, heart_disease) %>%
  filter(age >= 2, heart_disease == 1) %>%
  mutate(condition = "Heart Disease Only")

# here is a demonstration of the heart_disease_only data frame
kable(head(heart_disease_only, 5), caption = "3,942 x 4 (first 5 rows)")

# next, I combine the 2 data frames to create a scatter plot
combined_dataaa <- bind_rows(diabetes_onlyyy, heart_disease_onlyyy)

#common_bmi <- diabetes_dataset_filtered_bmi %>%
 # filter(bmi_filtered >= 25.01 & bmi_filtered <= 30.01) %>%
  #count(bmi_filtered) %>%
  #arrange(desc(n))  # Sort by highest count

#most_common_bmi <- common_bmi$bmi_filtered[1]  # Extract the most frequent bmi to mark a red horizontal line
common_bmi <- combined_dataaa %>%
  count(bmi) %>%
  arrange(desc(n))  # Sort by highest count

most_common_bmi <- common_bmi$bmi[1]

ggplot(combined_dataaa) +
  geom_point(aes(x = age, y = bmi, color = condition), alpha = 0.3) +  # Scatter plot with BMI
  geom_jitter(aes(x = age, y = bmi, color = condition), width = 0.1, height = 0.1, alpha = 0.3) +
 geom_hline(aes(yintercept = 27.32, color = "Common BMI = 27.32"), linetype = "solid", size = 0.3)  +  # Horizontal line marking common BMI
  scale_color_manual(
    values = c("Diabetes Only" = "cornflowerblue", 
               "Heart Disease Only" = "darkorchid4", 
               "Common BMI = 27.32" = "red"),
    labels = c("Common BMI = 27.32", "Diabetes Only", "Heart Disease Only")) +
  scale_x_continuous(breaks = seq(0, 80, by = 5)) + 
  scale_y_continuous(breaks = seq(10.01, 95.69, by = 10)) +
  labs(title = "BMI vs. Age Across Diabetes & Heart Disease",
       x = "Age",
       y = "BMI",
       color = "Condition") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5)) +
  theme(
    axis.text = element_text(size = 11),
    legend.text = element_text(size = 11),
    plot.title = element_text(size = 13)
  )

#ggplotly(interactive_combined_data)
```
```{r}
#diabetes_dataset_filtered_bmi <- diabetes_dataset %>%
 # mutate(bmi_filtered = ifelse(bmi >= 2, bmi, NA))

common_bmi <- combined_dataaa %>%
  count(bmi) %>%
  arrange(desc(n))  # Sort by highest count

most_common_bmi <- common_bmi$bmi[1]

# here I create 2 variables that represent the data frames I'll be working on 
diabetes_onlyy <- diabetes_dataset_filtered_bmi %>%
  select(age, bmi_filtered, diabetes) %>%
  filter(age >= 2, diabetes == 1) %>%
  mutate(condition = "Diabetes Only")

# here is a demonstration of the diabetes_only data frame
kable(head(diabetes_only, 5), caption = "8,500 x 4 (first 5 rows)")

heart_disease_onlyy <- diabetes_dataset_filtered_bmi %>%
  select(age, bmi_filtered, heart_disease) %>%
  filter(age >= 2, heart_disease == 1) %>%
  mutate(condition = "Heart Disease Only")

# here is a demonstration of the heart_disease_only data frame
kable(head(heart_disease_only, 5), caption = "3,942 x 4 (first 5 rows)")

# next, I combine the 2 data frames to create a scatter plot
combined_data <- bind_rows(diabetes_only, heart_disease_only)

common_bmi <- diabetes_dataset_filtered_bmi %>%
  filter(bmi_filtered >= 25.01 & bmi_filtered <= 30.01) %>%
  count(bmi_filtered) %>%
  arrange(desc(n))  # Sort by highest count

most_common_bmi <- common_bmi$bmi_filtered[1]  # Extract the most frequent bmi to mark a red horizontal line

ggplot(combined_data) +
  geom_point(aes(x = age, y = bmi_filtered, color = condition), alpha = 0.3) +  # Scatter plot with BMI
  geom_jitter(aes(x = age, y = bmi_filtered, color = condition), width = 0.1, height = 0.1, alpha = 0.3) +
  geom_hline(yintercept = most_common_bmi, linetype = "solid", color = "red", size = 0.3) +  # Horizontal line marking common BMI
  scale_color_manual(values = c("Diabetes Only" = "cornflowerblue", "Heart Disease Only" = "darkorchid4")) + 
  scale_x_continuous(breaks = seq(0, 80, by = 5)) + 
  scale_y_continuous(breaks = seq(10.01, 95.69, by = 10)) +
  labs(title = "BMI vs. Age Across Diabetes & Heart Disease",
       x = "Age",
       y = "BMI",
       color = "Condition") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5)) +
  theme(
    axis.text = element_text(size = 11),
    legend.text = element_text(size = 11),
    plot.title = element_text(size = 13)
  )
```

```{r}
library(dplyr)
library(ggplot2)
library(knitr) 

diabetes_dataset

# here I create 2 variables that represent the data frames I'll be working on 
diabetes_onlyyy <- diabetes_dataset %>%
  select(age, bmi, diabetes) %>%
  filter(age >= 2, diabetes == 1) %>%
  mutate(condition = "Diabetes Only")

# here is a display the diabetes_only data frame
kable(head(diabetes_only, 5), caption = "8,500 x 4 (first 5 rows)")

heart_disease_onlyyy <- diabetes_dataset %>%
  select(age, bmi, heart_disease) %>%
  filter(age >= 2, heart_disease == 1) %>%
  mutate(condition = "Heart Disease Only")

# here is a display the heart_disease_only data frame
kable(head(heart_disease_only, 5), caption = "3,942 x 4 (first 5 rows)")

# next, I combine the 2 data frames to create a scatter plot
combined_dataaa <- bind_rows(diabetes_onlyyy, heart_disease_onlyyy)

# here I want to show that there is a common BMI between individuals with diabetes only and individuals with heart disease only, I will show this by drawing a red horizontal line across the plot
common_bmi <- combined_dataaa %>%
  count(bmi) %>% # count bmi
  arrange(desc(n))  # sort by highest count

most_common_bmi <- common_bmi$bmi[1] # extract the most frequent bmi to mark a red horizontal line

ggplot(combined_dataaa) +
  geom_point(aes(x = age, y = bmi, color = condition), alpha = 0.3) +  # Scatter plot with BMI
  geom_jitter(aes(x = age, y = bmi, color = condition), width = 0.1, height = 0.1, alpha = 0.3) +
 geom_hline(aes(yintercept = 27.32, color = "Common BMI = 27.32"), linetype = "solid", size = 0.3)  +  # horizontal line marking common BMI
  scale_color_manual(
    values = c("Diabetes Only" = "cornflowerblue", 
               "Heart Disease Only" = "darkorchid4", 
               "Common BMI = 27.32" = "red"),
    labels = c("Common BMI = 27.32", "Diabetes Only", "Heart Disease Only")) +
  scale_x_continuous(breaks = seq(0, 80, by = 5)) + 
  scale_y_continuous(breaks = seq(10.01, 95.69, by = 10)) +
  labs(title = "BMI vs. Age Across Diabetes & Heart Disease",
       x = "Age",
       y = "BMI",
       color = "Condition") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5)) +
  theme(
    axis.text = element_text(size = 11),
    legend.text = element_text(size = 11),
    plot.title = element_text(size = 13)
  )
```

# ORIGINAL
```{r}
library(dplyr)
library(ggplot2)
library(knitr) 

diabetes_dataset_filtered_bmi <- diabetes_dataset %>%
  mutate(bmi_filtered = ifelse(bmi >= 2, bmi, NA))

# here I create 2 variables that represent the data frames I'll be working on 
diabetes_only <- diabetes_dataset_filtered_bmi %>%
  select(age, bmi_filtered, diabetes) %>%
  filter(age >= 2, diabetes == 1) %>%
  mutate(condition = "Diabetes Only")

# here is a demonstration of the diabetes_only data frame
kable(head(diabetes_only, 5), caption = "8,500 x 4 (first 5 rows)")

heart_disease_only <- diabetes_dataset_filtered_bmi %>%
  select(age, bmi_filtered, heart_disease) %>%
  filter(age >= 2, heart_disease == 1) %>%
  mutate(condition = "Heart Disease Only")

# here is a demonstration of the heart_disease_only data frame
kable(head(heart_disease_only, 5), caption = "3,942 x 4 (first 5 rows)")

# next, I combine the 2 data frames to create a scatter plot
combined_data <- bind_rows(diabetes_only, heart_disease_only)

common_bmi <- diabetes_dataset_filtered_bmi %>%
  filter(bmi_filtered >= 25.01 & bmi_filtered <= 30.01) %>%
  count(bmi_filtered) %>%
  arrange(desc(n))  # Sort by highest count

most_common_bmi <- common_bmi$bmi_filtered[1]  # Extract the most frequent bmi to mark a red horizontal line

ggplot(combined_data) +
  geom_point(aes(x = age, y = bmi_filtered, color = condition), alpha = 0.3) +  # Scatter plot with BMI
  geom_jitter(aes(x = age, y = bmi_filtered, color = condition), width = 0.1, height = 0.1, alpha = 0.3) +
  geom_hline(yintercept = most_common_bmi, linetype = "solid", color = "red", size = 0.3) +  # Horizontal line marking common BMI
  scale_color_manual(values = c("Diabetes Only" = "cornflowerblue", "Heart Disease Only" = "darkorchid4")) + 
  scale_x_continuous(breaks = seq(0, 80, by = 5)) + 
  scale_y_continuous(breaks = seq(10.01, 95.69, by = 10)) +
  labs(title = "BMI vs. Age Across Diabetes & Heart Disease",
       x = "Age",
       y = "BMI",
       color = "Condition") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5)) +
  theme(
    axis.text = element_text(size = 11),
    legend.text = element_text(size = 11),
    plot.title = element_text(size = 13)
  )
```


# create horizontal lines with this info
# Prediabetes & Type 2 Diabetes Risk:Often associated with BMI ≥25 (overweight or obese categories).
# Normal-Weight Diabetes: Some individuals develop diabetes even with a BMI <25, due to factors like genetics, visceral fat, and metabolic health
# Higher BMI & Diabetes Progression: A BMI ≥30 significantly increases the risk of insulin resistance and complications
```



